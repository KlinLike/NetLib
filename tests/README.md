# Tests æµ‹è¯•æ–‡ä»¶è¯´æ˜

æœ¬ç›®å½•åŒ…å« NetLib é¡¹ç›®çš„å„ç§æµ‹è¯•æ–‡ä»¶å’Œæµ‹è¯•è„šæœ¬ã€‚

---

## ğŸ“ æ–‡ä»¶åˆ—è¡¨

### 1. `test_kvs_array.c`
**ç”¨é€”**: KVS æ•°ç»„å®ç°çš„å•å…ƒæµ‹è¯•ç¨‹åº

**åŠŸèƒ½**:
- æµ‹è¯• `kvs_array` æ¨¡å—çš„æ‰€æœ‰åŠŸèƒ½
- åŒ…å« `create`, `destroy`, `set`, `get`, `mod`, `del`, `exist` ç­‰æ“ä½œçš„æµ‹è¯•
- æä¾›è¯¦ç»†çš„æµ‹è¯•è¾“å‡ºï¼Œæ˜¾ç¤ºæ¯ä¸ªæ“ä½œæ˜¯å¦æˆåŠŸ

**ç¼–è¯‘æ–¹å¼**:
```bash
gcc -o test_kvs_array test_kvs_array.c ../src/kvs_array.c -I../include -Wall
```

**è¿è¡Œæ–¹å¼**:
```bash
./test_kvs_array
```

**ä¾èµ–**:
- `../include/kvstore.h` - KVS å¤´æ–‡ä»¶
- `../src/kvs_array.c` - KVS æ•°ç»„å®ç°

**æµ‹è¯•è¦†ç›–**:
- âœ… åˆ›å»ºå’Œé”€æ¯æ•°ç»„
- âœ… è®¾ç½®é”®å€¼å¯¹
- âœ… è·å–é”®å€¼å¯¹
- âœ… æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
- âœ… ä¿®æ”¹é”®å€¼å¯¹
- âœ… åˆ é™¤é”®å€¼å¯¹
- âœ… é”™è¯¯å¤„ç†ï¼ˆå‚æ•°æ£€æŸ¥ã€é”®ä¸å­˜åœ¨ç­‰ï¼‰

---

### 2. `test_kvs.sh`
**ç”¨é€”**: ä¸€é”®ç¼–è¯‘å’Œæµ‹è¯•è„šæœ¬

**åŠŸèƒ½**:
- è‡ªåŠ¨æ¸…ç†æ—§çš„ç¼–è¯‘æ–‡ä»¶
- ç¼–è¯‘ `test_kvs_array.c` æµ‹è¯•ç¨‹åº
- è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºç»“æœ
- æä¾›å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°æ˜¾ç¤ºæµ‹è¯•è¿›åº¦å’Œç»“æœ

**ä½¿ç”¨æ–¹å¼**:
```bash
# æ–¹å¼1: ç›´æ¥è¿è¡Œ
./test_kvs.sh

# æ–¹å¼2: é€šè¿‡ bash è¿è¡Œ
bash test_kvs.sh
```

**è„šæœ¬æµç¨‹**:
1. **æ¸…ç†é˜¶æ®µ**: åˆ é™¤æ—§çš„å¯æ‰§è¡Œæ–‡ä»¶
2. **ç¼–è¯‘é˜¶æ®µ**: ä½¿ç”¨ gcc ç¼–è¯‘æµ‹è¯•ç¨‹åº
3. **æµ‹è¯•é˜¶æ®µ**: è¿è¡Œæµ‹è¯•ç¨‹åº
4. **ç»“æœæ£€æŸ¥**: æ˜¾ç¤ºæµ‹è¯•æ˜¯å¦é€šè¿‡

**è¾“å‡ºè¯´æ˜**:
- ğŸ”µ è“è‰²ï¼šæ ‡é¢˜å’Œåˆ†éš”çº¿
- ğŸŸ¡ é»„è‰²ï¼šé˜¶æ®µæç¤º
- ğŸŸ¢ ç»¿è‰²ï¼šæˆåŠŸä¿¡æ¯
- ğŸ”´ çº¢è‰²ï¼šå¤±è´¥ä¿¡æ¯

**é€€å‡ºç **:
- `0`: æµ‹è¯•æˆåŠŸ
- `1`: ç¼–è¯‘å¤±è´¥æˆ–æµ‹è¯•å¤±è´¥

---

### 3. `echo_client.py`
**ç”¨é€”**: Echo æœåŠ¡å™¨çš„ Python æµ‹è¯•å®¢æˆ·ç«¯

**åŠŸèƒ½**:
- è¿æ¥åˆ° Echo æœåŠ¡å™¨
- å‘é€æµ‹è¯•æ¶ˆæ¯
- æ¥æ”¶å¹¶éªŒè¯æœåŠ¡å™¨å“åº”
- ç”¨äºæµ‹è¯•ç½‘ç»œé€šä¿¡åŠŸèƒ½

**ä½¿ç”¨æ–¹å¼**:
```bash
python3 echo_client.py [host] [port]
```

**ä¾èµ–**:
- Python 3.x
- æ ‡å‡†åº“ï¼š`socket`, `sys`

**é€‚ç”¨åœºæ™¯**:
- æµ‹è¯• Echo æœåŠ¡å™¨çš„åŸºæœ¬åŠŸèƒ½
- éªŒè¯ç½‘ç»œè¿æ¥å’Œæ•°æ®ä¼ è¾“
- å‹åŠ›æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æµ‹è¯• KVS æ•°ç»„æ¨¡å—

**æ¨èæ–¹å¼**ï¼ˆä½¿ç”¨è„šæœ¬ï¼‰:
```bash
cd /root/MyGithub/NetLib
./tests/test_kvs.sh
```

**æ‰‹åŠ¨æ–¹å¼**:
```bash
cd /root/MyGithub/NetLib

# ç¼–è¯‘
gcc -o test_kvs_array tests/test_kvs_array.c src/kvs_array.c -I./include -Wall

# è¿è¡Œ
./test_kvs_array
```

### æµ‹è¯• Echo æœåŠ¡å™¨

1. å¯åŠ¨æœåŠ¡å™¨ï¼ˆåœ¨ä¸€ä¸ªç»ˆç«¯ï¼‰:
```bash
./server 2000
```

2. è¿è¡Œå®¢æˆ·ç«¯ï¼ˆåœ¨å¦ä¸€ä¸ªç»ˆç«¯ï¼‰:
```bash
python3 tests/echo_client.py localhost 2000
```

---

## ğŸ“ æ·»åŠ æ–°æµ‹è¯•

å¦‚æœéœ€è¦æ·»åŠ æ–°çš„æµ‹è¯•æ–‡ä»¶ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹å‘½åè§„èŒƒï¼š

- å•å…ƒæµ‹è¯•ï¼š`test_<æ¨¡å—å>.c`
- é›†æˆæµ‹è¯•ï¼š`integration_test_<åŠŸèƒ½å>.c`
- æµ‹è¯•è„šæœ¬ï¼š`test_<æ¨¡å—å>.sh`
- å®¢æˆ·ç«¯æµ‹è¯•ï¼š`<åè®®å>_client.py`

---

## ğŸ› è°ƒè¯•å»ºè®®

### ä½¿ç”¨ GDB è°ƒè¯•
```bash
gcc -g -o test_kvs_array tests/test_kvs_array.c src/kvs_array.c -I./include
gdb ./test_kvs_array
```

### å†…å­˜æ³„æ¼æ£€æŸ¥
```bash
# éœ€è¦å®‰è£… valgrind
valgrind --leak-check=full --show-leak-kinds=all ./test_kvs_array
```

### æŸ¥çœ‹è¯¦ç»†ç¼–è¯‘ä¿¡æ¯
```bash
gcc -Wall -Wextra -v -o test_kvs_array tests/test_kvs_array.c src/kvs_array.c -I./include
```

---

## ğŸ“Š æµ‹è¯•çŠ¶æ€

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ | æœ€åæ›´æ–° |
|------|---------|------|---------|
| KVS Array | `test_kvs_array.c` | âœ… é€šè¿‡ | 2025-11-02 |
| Echo Server | `echo_client.py` | âœ… å¯ç”¨ | - |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [kvs_array_issues.md](../docs/kvs_array_issues.md) - KVS æ•°ç»„æ¨¡å—çš„é—®é¢˜ä¿®å¤è®°å½•
- [Process_Log.md](../docs/Process_Log.md) - é¡¹ç›®å¼€å‘æ—¥å¿—
- [kvstore.h](../include/kvstore.h) - KVS æ¨¡å—å¤´æ–‡ä»¶

---

**æ³¨æ„**: æ‰€æœ‰æµ‹è¯•éƒ½åº”è¯¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„ç›¸å¯¹è·¯å¾„ã€‚

